# Workshop II: GitHub for Intermediate Users - Part B

# Version conflicts

Git is really good at tracking changes made to documents as they move through time.  Optimally, each version should fall into place somewhere in the linear history of the document.  However, there are situations where versions conflict and it isn't clear what version of a document is the most recent version.

![Pull the repo](images-2b/version-conflict.png)

Here's an example of a conflict arising from a simple version control system where versions are tracked by appending the date to the filename.  

This system works well if each collaborator is careful to always use the most recent version.  But if anyone fails to use the most recent version, it becomes unclear what should be the final version.

## Resolving a conflict that occurs when pushing

Sometimes when you attempt to push a commit, you have an unpleasant surprise: a warning saying that the repository has been updated since your last pull.

There are two common ways that this can happen. Sometimes I've been working on a document on one computer, then start working on it on a different computer having forgotten to pull the most recent commits from GitHub. Another possibility is that you've been working on a document for a long time, and during that time, a collaborator made changes to the same document and pushed them to GitHub before you made your changes.  

In the following example, my alter ego and collaborator, Tomy the Cat, has edited the Python script we were working on while I was editing it.  

![Conflicted change 1](images-2b/first-conflicted-change.png)

However, I was working offline in a text editor and changed the added number to 1 instead of 5.  

![Conflicted change 2](images-2b/second-conflicted-change.png)

Here's what happened when I tried to push my changes:

![Repo is outdated](images-2b/repo-outdated.png)

The problem is pretty easy to fix if I've been using Atom as my text editor.  Here are the steps to fix the problem:

Go to the Repository menu and select Pull.

![Pull the repo](images-2b/pull-repo.png)

I will then get a popup message like this:

![Conflict warning](images-2b/conflict-detected.png)

If I click on the "Open in Atom" button, I'll get this screen in the Atom editor:

![Choose conflict](images-2b/choose-conflict.png)

The editor presents me with a choice between my change and Tomy's change.  Of course I'm right, so I pick my change.  Now the popup has changed:

![Choose conflict](images-2b/conflict-fixed.png)

and I can now commit the resolved file.

## A better way to manage changes

When Tomy wanted to change the code, instead of committing his change directly to the master branch, he could have created a new branch.

![Create branch for change](images-2b/create-branch-change.png)

After the "patch" branch is created, a new page opens to create a pull request:

![Create pull request](images-2b/create-pull-request.png)

Notice that the pull request includes an "@mention" with the my username.  That generates an email to the collaborator:

![Email generated by request](images-2b/pull-request-email.png)

Clicking on the link to view the diff shows how the two branches differ:

![Online diff](images-2b/online-diff.png)

The collaborator can follow the link in the email to the pull request dialog and approve the change if they want.

![Pull request dialog](images-2b/branch-pull-request.png)

After clicking Merge pull request, there's a confirmation and opportunity to comment.

![Confirm merge](images-2b/confirm-merge.png)

A happy ending! The change was made without conflicts!

![Confirm merge](images-2b/successful-merge.png)

Let's imagine a less happy ending. Perhaps I didn't see Tomy's email about the pull request and had gone ahead and made my change directly to the master branch before merging his patch branch.  That's generated a conflict that now shows up in the pull request dialog.

![Confirm merge](images-2b/pull-request-merge-conflict.png)

Clicking on the Resolve conflicts button brings up the online editor showing where the conflicts lie:

![Confirm merge](images-2b/online-conflict-resolution.png)

After editing the document so that the conflict is gone, click the Mark as resolved button, then click Commit merge.

![Confirm merge](images-2b/online-conflict-resolved.png)

This merges the modified, unconflicted branch into the patch branch.  You'll then go back to the pull request screen and have an opportunity to merge the patch branch into the master branch. The pull request can then be merged and the patch branch deleted.

The creation of pull requests and resolving conflicts between branches can also be done offline, but the nice, linear record of the pull request history is best seen online.
